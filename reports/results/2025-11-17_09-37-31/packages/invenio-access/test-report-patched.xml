<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="114" time="123.284" timestamp="2025-11-17T09:28:53.519130+00:00" hostname="runnervmg1sw1"><testcase classname="tests.conftest" name="PYDOCSTYLE" time="0.018" /><testcase classname="tests.conftest" name="ISORT" time="0.147" /><testcase classname="tests.conftest" name="black" time="0.354" /><testcase classname="tests.test_admin" name="ISORT" time="0.009" /><testcase classname="tests.test_admin" name="black" time="0.167" /><testcase classname="tests.test_admin" name="test_admin" time="0.430" /><testcase classname="tests.test_cli" name="ISORT" time="0.058" /><testcase classname="tests.test_cli" name="black" time="0.227" /><testcase classname="tests.test_cli" name="test_access_cli_allow_action_empty" time="0.270" /><testcase classname="tests.test_cli" name="test_access_cli_allow_action_unknown_email" time="0.216" /><testcase classname="tests.test_cli" name="test_access_cli_allow_action_unknown_role" time="0.214" /><testcase classname="tests.test_cli" name="test_access_cli_allow_action_user" time="0.681" /><testcase classname="tests.test_cli" name="test_any_all_global" time="0.210" /><testcase classname="tests.test_cli" name="test_access_cli_allow_action_role" time="0.212" /><testcase classname="tests.test_cli" name="test_access_cli_deny_action_role" time="0.240" /><testcase classname="tests.test_cli" name="test_access_cli_list" time="0.203" /><testcase classname="tests.test_cli" name="test_access_matrix" time="0.878" /><testcase classname="tests.test_invenio_access" name="ISORT" time="0.035" /><testcase classname="tests.test_invenio_access" name="black" time="0.187" /><testcase classname="tests.test_invenio_access" name="test_version" time="0.001" /><testcase classname="tests.test_invenio_access" name="test_init" time="0.110" /><testcase classname="tests.test_invenio_access" name="test_init_app" time="0.198" /><testcase classname="tests.test_invenio_access" name="test_actions" time="0.097" /><testcase classname="tests.test_invenio_access" name="test_system_roles" time="0.100" /><testcase classname="tests.test_invenio_access" name="test_entrypoints" time="0.006" /><testcase classname="tests.test_invenio_access" name="test_alembic" time="0.530"><failure message="AssertionError: assert not [('add_table', Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionssystemroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionssystemroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;), schema=None)), ('add_index', Index('ix_access_actionssystemroles_action', Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_argument', Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_role_name', Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False))), ('add_table', Table('accounts_domain_category', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_category&gt;, primary_key=True, nullable=False), Column('label', String(length=255), table=&lt;accounts_domain_category&gt;), schema=None)), ('add_table', Table('accounts_domain_org', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_org&gt;, primary_key=True, nullable=False), Column('pid', String(length=255), table=&lt;accounts_domain_org&gt;), Column('name', String(length=255), table=&lt;accounts_domain_org&gt;, nullable=False), Column('json', JSON(), table=&lt;accounts_domain_org&gt;, nullable=False, default=CallableColumnDefault(&lt;function DomainOrg.&lt;lambda&gt; at 0x7f0f19987a60&gt;)), Column('parent_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domain_org&gt;), schema=None)), ('add_table', Table('accounts_role', MetaData(), Column('id', String(length=80), table=&lt;accounts_role&gt;, primary_key=True, nullable=False, default=CallableColumnDefault(&lt;function Role.&lt;lambda&gt; at 0x7f0f1990f240&gt;)), Column('name', String(length=80), table=&lt;accounts_role&gt;), Column('description', String(length=255), table=&lt;accounts_role&gt;), Column('is_managed', Boolean(), table=&lt;accounts_role&gt;, nullable=False, default=ScalarElementColumnDefault(True)), Column('version_id', Integer(), table=&lt;accounts_role&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user', MetaData(), Column('id', Integer(), table=&lt;accounts_user&gt;, primary_key=True, nullable=False), Column('username', String(length=255), table=&lt;accounts_user&gt;), Column('displayname', String(length=255), table=&lt;accounts_user&gt;), Column('email', String(length=255), table=&lt;accounts_user&gt;), Column('domain', String(length=255), table=&lt;accounts_user&gt;), Column('password', String(length=255), table=&lt;accounts_user&gt;), Column('active', Boolean(name='active'), table=&lt;accounts_user&gt;), Column('confirmed_at', DateTime(), table=&lt;accounts_user&gt;), Column('version_id', Integer(), table=&lt;accounts_user&gt;, nullable=False), Column('profile', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d8a0&gt;)), Column('preferences', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d9e0&gt;)), Column('blocked_at', DateTime(), table=&lt;accounts_user&gt;), Column('verified_at', DateTime(), table=&lt;accounts_user&gt;), Column('created', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('access_actionsroles', MetaData(), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;access_actionsroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsroles&gt;), schema=None)), ('add_index', Index('ix_access_actionsroles_action', Column('action', String(length=80), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_argument', Column('argument', String(length=255), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_role_id', Column('role_id', String(length=80), table=&lt;access_actionsroles&gt;, nullable=False))), ('add_table', Table('access_actionsusers', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;access_actionsusers&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsusers&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsusers&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsusers&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsusers&gt;), schema=None)), ('add_index', Index('ix_access_actionsusers_action', Column('action', String(length=80), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_argument', Column('argument', String(length=255), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_user_id', Column('user_id', Integer(), table=&lt;access_actionsusers&gt;, nullable=False))), ('add_table', Table('accounts_domains', MetaData(), Column('id', Integer(), table=&lt;accounts_domains&gt;, primary_key=True, nullable=False), Column('domain', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('tld', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('status', ChoiceType(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(&lt;DomainStatus.new: 1&gt;)), Column('flagged', Boolean(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(False)), Column('flagged_source', String(length=255), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault('')), Column('org_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domains&gt;), Column('category', Integer(), ForeignKey('accounts_domain_category.id'), table=&lt;accounts_domains&gt;), Column('num_users', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_active', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_inactive', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_confirmed', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_verified', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_blocked', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('created', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user_login_information', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_login_information&gt;, primary_key=True, nullable=False), Column('last_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('current_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('last_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('current_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('login_count', Integer(), table=&lt;accounts_user_login_information&gt;), schema=None)), ('add_table', Table('accounts_user_session_activity', MetaData(), Column('sid_s', String(length=255), table=&lt;accounts_user_session_activity&gt;, primary_key=True, nullable=False), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_session_activity&gt;), Column('ip', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('country', String(length=3), table=&lt;accounts_user_session_activity&gt;), Column('browser', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('browser_version', String(length=30), table=&lt;accounts_user_session_activity&gt;), Column('os', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('device', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('created', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_useridentity', MetaData(), Column('id', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('id_user', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_useridentity&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_index', Index('accounts_useridentity_id_user_method', Column('id_user', Integer(), table=&lt;accounts_useridentity&gt;, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), unique=True)), ('add_table', Table('accounts_userrole', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_userrole&gt;), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;accounts_userrole&gt;), schema=None)), ('add_table', Table('transaction', MetaData(), Column('id', BigInteger(), table=&lt;transaction&gt;, primary_key=True, nullable=False, default=Sequence('transaction_id_seq', metadata=MetaData())), Column('remote_addr', String(length=50), table=&lt;transaction&gt;), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;transaction&gt;), Column('issued_at', DateTime(), table=&lt;transaction&gt;, default=CallableColumnDefault(&lt;function utc_now at 0x7f0f17c81f80&gt;)), schema=None)), ('add_index', Index('ix_transaction_user_id', Column('user_id', Integer(), table=&lt;transaction&gt;)))]&#10; +  where [('add_table', Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionssystemroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionssystemroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;), schema=None)), ('add_index', Index('ix_access_actionssystemroles_action', Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_argument', Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_role_name', Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False))), ('add_table', Table('accounts_domain_category', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_category&gt;, primary_key=True, nullable=False), Column('label', String(length=255), table=&lt;accounts_domain_category&gt;), schema=None)), ('add_table', Table('accounts_domain_org', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_org&gt;, primary_key=True, nullable=False), Column('pid', String(length=255), table=&lt;accounts_domain_org&gt;), Column('name', String(length=255), table=&lt;accounts_domain_org&gt;, nullable=False), Column('json', JSON(), table=&lt;accounts_domain_org&gt;, nullable=False, default=CallableColumnDefault(&lt;function DomainOrg.&lt;lambda&gt; at 0x7f0f19987a60&gt;)), Column('parent_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domain_org&gt;), schema=None)), ('add_table', Table('accounts_role', MetaData(), Column('id', String(length=80), table=&lt;accounts_role&gt;, primary_key=True, nullable=False, default=CallableColumnDefault(&lt;function Role.&lt;lambda&gt; at 0x7f0f1990f240&gt;)), Column('name', String(length=80), table=&lt;accounts_role&gt;), Column('description', String(length=255), table=&lt;accounts_role&gt;), Column('is_managed', Boolean(), table=&lt;accounts_role&gt;, nullable=False, default=ScalarElementColumnDefault(True)), Column('version_id', Integer(), table=&lt;accounts_role&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user', MetaData(), Column('id', Integer(), table=&lt;accounts_user&gt;, primary_key=True, nullable=False), Column('username', String(length=255), table=&lt;accounts_user&gt;), Column('displayname', String(length=255), table=&lt;accounts_user&gt;), Column('email', String(length=255), table=&lt;accounts_user&gt;), Column('domain', String(length=255), table=&lt;accounts_user&gt;), Column('password', String(length=255), table=&lt;accounts_user&gt;), Column('active', Boolean(name='active'), table=&lt;accounts_user&gt;), Column('confirmed_at', DateTime(), table=&lt;accounts_user&gt;), Column('version_id', Integer(), table=&lt;accounts_user&gt;, nullable=False), Column('profile', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d8a0&gt;)), Column('preferences', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d9e0&gt;)), Column('blocked_at', DateTime(), table=&lt;accounts_user&gt;), Column('verified_at', DateTime(), table=&lt;accounts_user&gt;), Column('created', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('access_actionsroles', MetaData(), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;access_actionsroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsroles&gt;), schema=None)), ('add_index', Index('ix_access_actionsroles_action', Column('action', String(length=80), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_argument', Column('argument', String(length=255), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_role_id', Column('role_id', String(length=80), table=&lt;access_actionsroles&gt;, nullable=False))), ('add_table', Table('access_actionsusers', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;access_actionsusers&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsusers&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsusers&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsusers&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsusers&gt;), schema=None)), ('add_index', Index('ix_access_actionsusers_action', Column('action', String(length=80), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_argument', Column('argument', String(length=255), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_user_id', Column('user_id', Integer(), table=&lt;access_actionsusers&gt;, nullable=False))), ('add_table', Table('accounts_domains', MetaData(), Column('id', Integer(), table=&lt;accounts_domains&gt;, primary_key=True, nullable=False), Column('domain', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('tld', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('status', ChoiceType(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(&lt;DomainStatus.new: 1&gt;)), Column('flagged', Boolean(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(False)), Column('flagged_source', String(length=255), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault('')), Column('org_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domains&gt;), Column('category', Integer(), ForeignKey('accounts_domain_category.id'), table=&lt;accounts_domains&gt;), Column('num_users', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_active', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_inactive', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_confirmed', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_verified', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_blocked', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('created', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user_login_information', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_login_information&gt;, primary_key=True, nullable=False), Column('last_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('current_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('last_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('current_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('login_count', Integer(), table=&lt;accounts_user_login_information&gt;), schema=None)), ('add_table', Table('accounts_user_session_activity', MetaData(), Column('sid_s', String(length=255), table=&lt;accounts_user_session_activity&gt;, primary_key=True, nullable=False), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_session_activity&gt;), Column('ip', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('country', String(length=3), table=&lt;accounts_user_session_activity&gt;), Column('browser', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('browser_version', String(length=30), table=&lt;accounts_user_session_activity&gt;), Column('os', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('device', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('created', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_useridentity', MetaData(), Column('id', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('id_user', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_useridentity&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_index', Index('accounts_useridentity_id_user_method', Column('id_user', Integer(), table=&lt;accounts_useridentity&gt;, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), unique=True)), ('add_table', Table('accounts_userrole', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_userrole&gt;), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;accounts_userrole&gt;), schema=None)), ('add_table', Table('transaction', MetaData(), Column('id', BigInteger(), table=&lt;transaction&gt;, primary_key=True, nullable=False, default=Sequence('transaction_id_seq', metadata=MetaData())), Column('remote_addr', String(length=50), table=&lt;transaction&gt;), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;transaction&gt;), Column('issued_at', DateTime(), table=&lt;transaction&gt;, default=CallableColumnDefault(&lt;function utc_now at 0x7f0f17c81f80&gt;)), schema=None)), ('add_index', Index('ix_transaction_user_id', Column('user_id', Integer(), table=&lt;transaction&gt;)))] = compare_metadata()&#10; +    where compare_metadata = &lt;flask_alembic.extension.Alembic object at 0x7f0f172177d0&gt;.compare_metadata&#10; +      where &lt;flask_alembic.extension.Alembic object at 0x7f0f172177d0&gt; = &lt;invenio_db.ext.InvenioDB object at 0x7f0f172165a0&gt;.alembic">app = &lt;Flask 'testapp'&gt;

    def test_alembic(app):
        """Test alembic recipes."""
        ext = app.extensions["invenio-db"]
    
        with app.app_context():
            if db.engine.name == "sqlite":
                raise pytest.skip("Upgrades are not supported on SQLite.")
    
            assert not ext.alembic.compare_metadata()
            db.drop_all()
            drop_alembic_version_table()
            ext.alembic.upgrade()
    
&gt;           assert not ext.alembic.compare_metadata()
E           AssertionError: assert not [('add_table', Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionssystemroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionssystemroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;), schema=None)), ('add_index', Index('ix_access_actionssystemroles_action', Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_argument', Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_role_name', Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False))), ('add_table', Table('accounts_domain_category', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_category&gt;, primary_key=True, nullable=False), Column('label', String(length=255), table=&lt;accounts_domain_category&gt;), schema=None)), ('add_table', Table('accounts_domain_org', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_org&gt;, primary_key=True, nullable=False), Column('pid', String(length=255), table=&lt;accounts_domain_org&gt;), Column('name', String(length=255), table=&lt;accounts_domain_org&gt;, nullable=False), Column('json', JSON(), table=&lt;accounts_domain_org&gt;, nullable=False, default=CallableColumnDefault(&lt;function DomainOrg.&lt;lambda&gt; at 0x7f0f19987a60&gt;)), Column('parent_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domain_org&gt;), schema=None)), ('add_table', Table('accounts_role', MetaData(), Column('id', String(length=80), table=&lt;accounts_role&gt;, primary_key=True, nullable=False, default=CallableColumnDefault(&lt;function Role.&lt;lambda&gt; at 0x7f0f1990f240&gt;)), Column('name', String(length=80), table=&lt;accounts_role&gt;), Column('description', String(length=255), table=&lt;accounts_role&gt;), Column('is_managed', Boolean(), table=&lt;accounts_role&gt;, nullable=False, default=ScalarElementColumnDefault(True)), Column('version_id', Integer(), table=&lt;accounts_role&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user', MetaData(), Column('id', Integer(), table=&lt;accounts_user&gt;, primary_key=True, nullable=False), Column('username', String(length=255), table=&lt;accounts_user&gt;), Column('displayname', String(length=255), table=&lt;accounts_user&gt;), Column('email', String(length=255), table=&lt;accounts_user&gt;), Column('domain', String(length=255), table=&lt;accounts_user&gt;), Column('password', String(length=255), table=&lt;accounts_user&gt;), Column('active', Boolean(name='active'), table=&lt;accounts_user&gt;), Column('confirmed_at', DateTime(), table=&lt;accounts_user&gt;), Column('version_id', Integer(), table=&lt;accounts_user&gt;, nullable=False), Column('profile', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d8a0&gt;)), Column('preferences', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d9e0&gt;)), Column('blocked_at', DateTime(), table=&lt;accounts_user&gt;), Column('verified_at', DateTime(), table=&lt;accounts_user&gt;), Column('created', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('access_actionsroles', MetaData(), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;access_actionsroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsroles&gt;), schema=None)), ('add_index', Index('ix_access_actionsroles_action', Column('action', String(length=80), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_argument', Column('argument', String(length=255), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_role_id', Column('role_id', String(length=80), table=&lt;access_actionsroles&gt;, nullable=False))), ('add_table', Table('access_actionsusers', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;access_actionsusers&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsusers&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsusers&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsusers&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsusers&gt;), schema=None)), ('add_index', Index('ix_access_actionsusers_action', Column('action', String(length=80), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_argument', Column('argument', String(length=255), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_user_id', Column('user_id', Integer(), table=&lt;access_actionsusers&gt;, nullable=False))), ('add_table', Table('accounts_domains', MetaData(), Column('id', Integer(), table=&lt;accounts_domains&gt;, primary_key=True, nullable=False), Column('domain', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('tld', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('status', ChoiceType(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(&lt;DomainStatus.new: 1&gt;)), Column('flagged', Boolean(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(False)), Column('flagged_source', String(length=255), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault('')), Column('org_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domains&gt;), Column('category', Integer(), ForeignKey('accounts_domain_category.id'), table=&lt;accounts_domains&gt;), Column('num_users', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_active', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_inactive', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_confirmed', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_verified', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_blocked', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('created', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user_login_information', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_login_information&gt;, primary_key=True, nullable=False), Column('last_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('current_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('last_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('current_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('login_count', Integer(), table=&lt;accounts_user_login_information&gt;), schema=None)), ('add_table', Table('accounts_user_session_activity', MetaData(), Column('sid_s', String(length=255), table=&lt;accounts_user_session_activity&gt;, primary_key=True, nullable=False), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_session_activity&gt;), Column('ip', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('country', String(length=3), table=&lt;accounts_user_session_activity&gt;), Column('browser', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('browser_version', String(length=30), table=&lt;accounts_user_session_activity&gt;), Column('os', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('device', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('created', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_useridentity', MetaData(), Column('id', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('id_user', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_useridentity&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_index', Index('accounts_useridentity_id_user_method', Column('id_user', Integer(), table=&lt;accounts_useridentity&gt;, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), unique=True)), ('add_table', Table('accounts_userrole', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_userrole&gt;), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;accounts_userrole&gt;), schema=None)), ('add_table', Table('transaction', MetaData(), Column('id', BigInteger(), table=&lt;transaction&gt;, primary_key=True, nullable=False, default=Sequence('transaction_id_seq', metadata=MetaData())), Column('remote_addr', String(length=50), table=&lt;transaction&gt;), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;transaction&gt;), Column('issued_at', DateTime(), table=&lt;transaction&gt;, default=CallableColumnDefault(&lt;function utc_now at 0x7f0f17c81f80&gt;)), schema=None)), ('add_index', Index('ix_transaction_user_id', Column('user_id', Integer(), table=&lt;transaction&gt;)))]
E            +  where [('add_table', Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionssystemroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionssystemroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;), schema=None)), ('add_index', Index('ix_access_actionssystemroles_action', Column('action', String(length=80), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_argument', Column('argument', String(length=255), table=&lt;access_actionssystemroles&gt;))), ('add_index', Index('ix_access_actionssystemroles_role_name', Column('role_name', String(length=40), table=&lt;access_actionssystemroles&gt;, nullable=False))), ('add_table', Table('accounts_domain_category', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_category&gt;, primary_key=True, nullable=False), Column('label', String(length=255), table=&lt;accounts_domain_category&gt;), schema=None)), ('add_table', Table('accounts_domain_org', MetaData(), Column('id', Integer(), table=&lt;accounts_domain_org&gt;, primary_key=True, nullable=False), Column('pid', String(length=255), table=&lt;accounts_domain_org&gt;), Column('name', String(length=255), table=&lt;accounts_domain_org&gt;, nullable=False), Column('json', JSON(), table=&lt;accounts_domain_org&gt;, nullable=False, default=CallableColumnDefault(&lt;function DomainOrg.&lt;lambda&gt; at 0x7f0f19987a60&gt;)), Column('parent_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domain_org&gt;), schema=None)), ('add_table', Table('accounts_role', MetaData(), Column('id', String(length=80), table=&lt;accounts_role&gt;, primary_key=True, nullable=False, default=CallableColumnDefault(&lt;function Role.&lt;lambda&gt; at 0x7f0f1990f240&gt;)), Column('name', String(length=80), table=&lt;accounts_role&gt;), Column('description', String(length=255), table=&lt;accounts_role&gt;), Column('is_managed', Boolean(), table=&lt;accounts_role&gt;, nullable=False, default=ScalarElementColumnDefault(True)), Column('version_id', Integer(), table=&lt;accounts_role&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_role&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user', MetaData(), Column('id', Integer(), table=&lt;accounts_user&gt;, primary_key=True, nullable=False), Column('username', String(length=255), table=&lt;accounts_user&gt;), Column('displayname', String(length=255), table=&lt;accounts_user&gt;), Column('email', String(length=255), table=&lt;accounts_user&gt;), Column('domain', String(length=255), table=&lt;accounts_user&gt;), Column('password', String(length=255), table=&lt;accounts_user&gt;), Column('active', Boolean(name='active'), table=&lt;accounts_user&gt;), Column('confirmed_at', DateTime(), table=&lt;accounts_user&gt;), Column('version_id', Integer(), table=&lt;accounts_user&gt;, nullable=False), Column('profile', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d8a0&gt;)), Column('preferences', JSON(), table=&lt;accounts_user&gt;, default=CallableColumnDefault(&lt;function User.&lt;lambda&gt; at 0x7f0f1994d9e0&gt;)), Column('blocked_at', DateTime(), table=&lt;accounts_user&gt;), Column('verified_at', DateTime(), table=&lt;accounts_user&gt;), Column('created', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('access_actionsroles', MetaData(), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;access_actionsroles&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsroles&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsroles&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsroles&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsroles&gt;), schema=None)), ('add_index', Index('ix_access_actionsroles_action', Column('action', String(length=80), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_argument', Column('argument', String(length=255), table=&lt;access_actionsroles&gt;))), ('add_index', Index('ix_access_actionsroles_role_id', Column('role_id', String(length=80), table=&lt;access_actionsroles&gt;, nullable=False))), ('add_table', Table('access_actionsusers', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;access_actionsusers&gt;, nullable=False), Column('id', Integer(), table=&lt;access_actionsusers&gt;, primary_key=True, nullable=False), Column('action', String(length=80), table=&lt;access_actionsusers&gt;), Column('exclude', Boolean(name='exclude'), table=&lt;access_actionsusers&gt;, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=&lt;access_actionsusers&gt;), schema=None)), ('add_index', Index('ix_access_actionsusers_action', Column('action', String(length=80), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_argument', Column('argument', String(length=255), table=&lt;access_actionsusers&gt;))), ('add_index', Index('ix_access_actionsusers_user_id', Column('user_id', Integer(), table=&lt;access_actionsusers&gt;, nullable=False))), ('add_table', Table('accounts_domains', MetaData(), Column('id', Integer(), table=&lt;accounts_domains&gt;, primary_key=True, nullable=False), Column('domain', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('tld', String(length=255), table=&lt;accounts_domains&gt;, nullable=False), Column('status', ChoiceType(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(&lt;DomainStatus.new: 1&gt;)), Column('flagged', Boolean(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(False)), Column('flagged_source', String(length=255), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault('')), Column('org_id', Integer(), ForeignKey('accounts_domain_org.id'), table=&lt;accounts_domains&gt;), Column('category', Integer(), ForeignKey('accounts_domain_category.id'), table=&lt;accounts_domains&gt;), Column('num_users', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_active', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_inactive', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_confirmed', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_verified', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_blocked', Integer(), table=&lt;accounts_domains&gt;, nullable=False, default=ScalarElementColumnDefault(0)), Column('created', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_domains&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_user_login_information', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_login_information&gt;, primary_key=True, nullable=False), Column('last_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('current_login_at', DateTime(), table=&lt;accounts_user_login_information&gt;), Column('last_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('current_login_ip', IPAddressType(length=50), table=&lt;accounts_user_login_information&gt;), Column('login_count', Integer(), table=&lt;accounts_user_login_information&gt;), schema=None)), ('add_table', Table('accounts_user_session_activity', MetaData(), Column('sid_s', String(length=255), table=&lt;accounts_user_session_activity&gt;, primary_key=True, nullable=False), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_user_session_activity&gt;), Column('ip', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('country', String(length=3), table=&lt;accounts_user_session_activity&gt;), Column('browser', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('browser_version', String(length=30), table=&lt;accounts_user_session_activity&gt;), Column('os', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('device', String(length=80), table=&lt;accounts_user_session_activity&gt;), Column('created', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_user_session_activity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_table', Table('accounts_useridentity', MetaData(), Column('id', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), Column('id_user', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_useridentity&gt;, nullable=False), Column('created', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c4a0&gt;)), Column('updated', DateTime(), table=&lt;accounts_useridentity&gt;, nullable=False, default=CallableColumnDefault(&lt;function datetime.utcnow at 0x7f0f1b91c5e0&gt;)), schema=None)), ('add_index', Index('accounts_useridentity_id_user_method', Column('id_user', Integer(), table=&lt;accounts_useridentity&gt;, nullable=False), Column('method', String(length=255), table=&lt;accounts_useridentity&gt;, primary_key=True, nullable=False), unique=True)), ('add_table', Table('accounts_userrole', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;accounts_userrole&gt;), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=&lt;accounts_userrole&gt;), schema=None)), ('add_table', Table('transaction', MetaData(), Column('id', BigInteger(), table=&lt;transaction&gt;, primary_key=True, nullable=False, default=Sequence('transaction_id_seq', metadata=MetaData())), Column('remote_addr', String(length=50), table=&lt;transaction&gt;), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=&lt;transaction&gt;), Column('issued_at', DateTime(), table=&lt;transaction&gt;, default=CallableColumnDefault(&lt;function utc_now at 0x7f0f17c81f80&gt;)), schema=None)), ('add_index', Index('ix_transaction_user_id', Column('user_id', Integer(), table=&lt;transaction&gt;)))] = compare_metadata()
E            +    where compare_metadata = &lt;flask_alembic.extension.Alembic object at 0x7f0f172177d0&gt;.compare_metadata
E            +      where &lt;flask_alembic.extension.Alembic object at 0x7f0f172177d0&gt; = &lt;invenio_db.ext.InvenioDB object at 0x7f0f172165a0&gt;.alembic

app        = &lt;Flask 'testapp'&gt;
ext        = &lt;invenio_db.ext.InvenioDB object at 0x7f0f172165a0&gt;

tests/test_invenio_access.py:137: AssertionError</failure></testcase><testcase classname="tests.test_loaders" name="ISORT" time="0.018" /><testcase classname="tests.test_loaders" name="black" time="0.174" /><testcase classname="tests.test_loaders" name="test_load_permissions_on_request_loaded" time="0.212" /><testcase classname="tests.test_loaders" name="test_load_permissions_on_identity_loaded" time="0.246" /><testcase classname="tests.test_loaders" name="test_disabled_loader" time="0.202" /><testcase classname="tests.test_permissions" name="ISORT" time="0.069" /><testcase classname="tests.test_permissions" name="black" time="0.257" /><testcase classname="tests.test_permissions" name="test_allow_by_user_id" time="0.255" /><testcase classname="tests.test_permissions" name="test_deny_by_user_id" time="0.258" /><testcase classname="tests.test_permissions" name="test_allow_deny_by_user_id" time="0.264" /><testcase classname="tests.test_permissions" name="test_allow_by_role" time="0.263" /><testcase classname="tests.test_permissions" name="test_deny_by_role" time="0.295" /><testcase classname="tests.test_permissions" name="test_allow_by_user_id_and_role" time="0.267" /><testcase classname="tests.test_permissions" name="test_deny_by_user_id_and_role" time="0.275" /><testcase classname="tests.test_permissions" name="test_allow_by_action_expands_to_user_id" time="0.402" /><testcase classname="tests.test_permissions" name="test_deny_by_action_expands_to_user_id" time="0.326" /><testcase classname="tests.test_permissions" name="test_allow_by_action_expands_to_role" time="0.293" /><testcase classname="tests.test_permissions" name="test_deny_by_action_expands_to_role" time="0.345" /><testcase classname="tests.test_permissions" name="test_allow_by_action_expands_to_user_id_and_role" time="0.322" /><testcase classname="tests.test_permissions" name="test_deny_by_action_expands_to_user_id_and_role" time="0.332" /><testcase classname="tests.test_permissions" name="test_allow_by_action_expands_to_user_id_with_argument" time="0.356" /><testcase classname="tests.test_permissions" name="test_system_role_name" time="0.212" /><testcase classname="tests.test_permissions" name="test_system_roles" time="0.345" /><testcase classname="tests.test_permissions" name="test_allow_by_default" time="0.287" /><testcase classname="tests.test_permissions_cache" name="ISORT" time="0.152" /><testcase classname="tests.test_permissions_cache" name="black" time="0.408" /><testcase classname="tests.test_permissions_cache" name="test_invenio_access_permission_cache" time="0.255" /><testcase classname="tests.test_permissions_cache" name="test_invenio_access_permission_cache_redis" time="0.455" /><testcase classname="tests.test_permissions_cache" name="test_invenio_access_cache_performance" time="102.157" /><testcase classname="tests.test_permissions_cache" name="test_invenio_access_permission_cache_users_updates" time="0.303" /><testcase classname="tests.test_permissions_cache" name="test_invenio_access_permission_cache_roles_updates" time="0.291" /><testcase classname="tests.test_permissions_cache" name="test_invenio_access_permission_cache_system_roles_updates" time="0.274" /><testcase classname="tests.test_permissions_cache" name="test_dynamic_permission_needs_cache_invalidation" time="0.243" /><testcase classname="invenio_access.__init__" name="PYDOCSTYLE" time="0.009" /><testcase classname="invenio_access.__init__" name="ISORT" time="0.049" /><testcase classname="invenio_access.__init__" name="black" time="0.185" /><testcase classname="invenio_access.__init__" name="invenio_access" time="0.465" /><testcase classname="invenio_access.admin" name="PYDOCSTYLE" time="0.011" /><testcase classname="invenio_access.admin" name="ISORT" time="0.030" /><testcase classname="invenio_access.admin" name="black" time="0.190" /><testcase classname="invenio_access.alembic.04480be1593e_add_actionsystemroles" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_access.alembic.04480be1593e_add_actionsystemroles" name="ISORT" time="0.017" /><testcase classname="invenio_access.alembic.04480be1593e_add_actionsystemroles" name="black" time="0.180" /><testcase classname="invenio_access.alembic.2069a982633b_add_on_delete_cascade_constraint" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_access.alembic.2069a982633b_add_on_delete_cascade_constraint" name="ISORT" time="0.019" /><testcase classname="invenio_access.alembic.2069a982633b_add_on_delete_cascade_constraint" name="black" time="0.180" /><testcase classname="invenio_access.alembic.2f63be7b7572_create_access_tables" name="PYDOCSTYLE" time="0.009" /><testcase classname="invenio_access.alembic.2f63be7b7572_create_access_tables" name="ISORT" time="0.022" /><testcase classname="invenio_access.alembic.2f63be7b7572_create_access_tables" name="black" time="0.186" /><testcase classname="invenio_access.alembic.67ba0de65fbb_create_access_branch" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_access.alembic.67ba0de65fbb_create_access_branch" name="ISORT" time="0.009" /><testcase classname="invenio_access.alembic.67ba0de65fbb_create_access_branch" name="black" time="0.177" /><testcase classname="invenio_access.alembic.842a62b56e60_change_fk_accountsrole_to_string_downgrade" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_access.alembic.842a62b56e60_change_fk_accountsrole_to_string_downgrade" name="ISORT" time="0.013" /><testcase classname="invenio_access.alembic.842a62b56e60_change_fk_accountsrole_to_string_downgrade" name="black" time="0.179" /><testcase classname="invenio_access.alembic.dbe499bfda43_prevent_null_in_actionusers_for_" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_access.alembic.dbe499bfda43_prevent_null_in_actionusers_for_" name="ISORT" time="0.022" /><testcase classname="invenio_access.alembic.dbe499bfda43_prevent_null_in_actionusers_for_" name="black" time="0.177" /><testcase classname="invenio_access.alembic.f9843093f686_change_fk_accountsrole_to_string_upgrade" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_access.alembic.f9843093f686_change_fk_accountsrole_to_string_upgrade" name="ISORT" time="0.013" /><testcase classname="invenio_access.alembic.f9843093f686_change_fk_accountsrole_to_string_upgrade" name="black" time="0.173" /><testcase classname="invenio_access.cli" name="PYDOCSTYLE" time="0.035" /><testcase classname="invenio_access.cli" name="ISORT" time="0.066" /><testcase classname="invenio_access.cli" name="black" time="0.244" /><testcase classname="invenio_access.config" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_access.config" name="ISORT" time="0.006" /><testcase classname="invenio_access.config" name="black" time="0.170" /><testcase classname="invenio_access.ext" name="PYDOCSTYLE" time="0.019" /><testcase classname="invenio_access.ext" name="ISORT" time="0.030" /><testcase classname="invenio_access.ext" name="black" time="0.192" /><testcase classname="invenio_access.factory" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_access.factory" name="ISORT" time="0.009" /><testcase classname="invenio_access.factory" name="black" time="0.169" /><testcase classname="invenio_access.loaders" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_access.loaders" name="ISORT" time="0.008" /><testcase classname="invenio_access.loaders" name="black" time="0.166" /><testcase classname="invenio_access.models" name="PYDOCSTYLE" time="0.023" /><testcase classname="invenio_access.models" name="ISORT" time="0.046" /><testcase classname="invenio_access.models" name="black" time="0.215" /><testcase classname="invenio_access.permissions" name="PYDOCSTYLE" time="0.015" /><testcase classname="invenio_access.permissions" name="ISORT" time="0.033" /><testcase classname="invenio_access.permissions" name="black" time="0.194" /><testcase classname="invenio_access.proxies" name="PYDOCSTYLE" time="0.002" /><testcase classname="invenio_access.proxies" name="ISORT" time="0.007" /><testcase classname="invenio_access.proxies" name="black" time="0.163" /><testcase classname="invenio_access.utils" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_access.utils" name="ISORT" time="0.009" /><testcase classname="invenio_access.utils" name="black" time="0.168" /></testsuite></testsuites>